{% extends 'base.html' %}
{% load mathfilters %}

{% block content %}
<table class="table">
    <thead>
      <tr>
        <th scope="col">ID</th>
        <th scope="col">user</th>
        <th scope="col">PROMO</th>
        <th scope="col">Общая стоимость</th>
        <th scope="col">валюта</th>
        <th scope="col">стоимость с учетом курса</th>
        <th scope="col">сумма к оплате</th>
        <th scope="col">status</th>
      </tr>
    </thead>
    <tbody>

        {%for invoice in all_invoices%}
        <tr>
        <td><a href="{% url 'invoice_page' invoice.id %}" target="_blank">{{invoice.id}}</a></td>
        <td>{{invoice.user}}</td>
        <td>{{invoice.promo}}</td>
        <td>{{invoice.total_amount}}</td>
        <td>{{invoice.currency}}</td>
        <td>{{invoice.full_amount_on_curr}}</td>
        <td>{{ invoice.total_amount_on_curr}}</td>
        <td>
            <form action="{% url 'change_invoice' %}" method="POST" id='change_status_{{invoice.id}}'>
                {%csrf_token%}
                <input type="hidden" name='id_order' value={{invoice.id}}>
                <select onchange="document.getElementById('change_status_{{invoice.id}}').submit()" name='status'>
                    {% for x,y in all_status.fields.status.choices %}
                    <option value="{{ x }}"{% if invoice.get_status_display == y %} selected{% endif %}>{{ y }}</option>
                    {% endfor %}
            </select></form>
        </td>
        </tr>
        {%endfor%}
        
        </tbody>
    </table>

{% endblock %}